# Healthy Food Recommendation System 

In an era where personal well-being and nutrition are pivotal, the need for personalized and healthy food recommendations is more important than ever. This system not only caters to individual taste preferences but also ensures that the recommendations align with healthier choices.

This repository contains the [data](https://drive.google.com/drive/folders/18Hr6MFPINIqf1huRtZ5L-14fYyzxKRTM?usp=drive_link) and the code needed for a robust healthy food recommendation system. It analyzes users' meal descriptions to provide personalized recommendations, calculates health scores, and clusters food items to provide nutritious alternatives.

## 📂 Directory Structure

<pre>
main/
│   ├── healthy_food_recommender.py       # Main file combining all parts and providing healthy alternatives
│   └── healthy_alternatives.json    # Healthy alternatives for each recommended food item
│
data/
│   ├── preprocessed data/
│   │   ├── Final Health Scores Normalized Linear.csv   # Normalized health scores for each food item
│   │   ├── food_nutrients_transformed.csv               # After nutrient preprocessing, adding nutrient columns
│   │   ├── foodClusters.pickle                         # Clusters of similar food items
│   │   └── foodVectors.pickle                          # Embeddings of food items using BERT
│   │
│   └── raw data/
│       ├── final_user_data.csv                          # Final user data after preprocessing
│       ├── food_nutrient.csv                            # Nutrient info for each food item
│       └── nutrient.csv                                 # General nutrient information
│       └── food.csv                                 # Food Information
models/
│   └── ease.py                      # EASE recommendation model
│
preprocessing/
    ├── health_score_calculation.py    # Script to calculate normalized health scores
    ├── n_clusters.py                  # Generates graph using elbow method to determine cluster number
    ├── nutrient_data_preprocessing.py # Generates nutrient info for each food item using food_nutrient.csv & nutrient.csv
    └── preprocessing.py               # Methods to transform the final_user_data.csv
</pre>


## 🚀 Workflow

### **Part I: EASE (Personalized Recommendations)**
The aim of this part is to generate food recommendations that extend beyond the user's existing preferences, encouraging them to explore new items that might interest them.

1. **Preprocessing**
   - **Extract Meal Descriptions**: From meal descriptions file
   - **Generate User Data**: Using extracted meal descriptions → Output: `final_user_data.csv`
2. **Generate Recommendations**: Using `final_user_data.csv` → Food IDs for each user

### **Part II: Health Score Calculation**
1. **Preprocessing**
   - **Transform Nutrient Data**: Using `data/raw data/food_nutrients.csv` & `data/raw data/nutrient.csv` → Output: `data/preprocessed data/food_nutrient_transformed.csv`
2. **Calculate Health Score**: For each food item in `data/preprocessed data/food_nutrient_transformed.csv`

### **Part III: Clustering and Final Score**
1. **Create BERT Embeddings**: For food items
2. **Cluster Food Items**: Using BERT embeddings, store clusters in `data/preprocessed data/foodClusters.pickle` and embeddings in `data/preprocessed data/foodVectors.pickle`
3. **Retrieve Similar Items**: Use clusters to get similar items
4. **Calculate Similarity Score**: Using cosine similarity between embeddings
5. **Calculate Final Score**: Final Score = alpha * similarity_score + (1-alpha) * health_score, where alpha ranges from [0,1]. Alpha controls how healthy or similar the item should be.

## ⚙️ How to Run

1. Run the `main/healthy_food_recommender.py` file:
2. After successful execution, a `main/healthy_alternatives.json` file will be generated.
3. This JSON file contains personalized recommendations generated by EASE for each user. Alongside each recommendation, healthier alternatives will also be listed for the users to explore and consider.
